<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>ENTROPY â€” Randomness Audit</title>
  <link rel="stylesheet" href="/static/styles.css"/>
  <script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>
</head>
<body>
  <div class="topbar">
    <div class="brand">
      <img src="/Entropy.png" alt="ENTROPY" class="logo" />
      <div class="brand-text">
        <div class="name">ENTROPY</div>
        <div class="tag">AI-powered chaos detector â€¢ Live pattern research â€¢ 20 years of data</div>
      </div>
    </div>
    <div class="controls">
      <a href="/bet" class="arena-btn">ğŸ® Prediction Arena</a>
      <select id="feedSelect">
        <option value="powerball">Powerball</option>
        <option value="megamillions">Mega Millions</option>
      </select>
      <button id="btnNow">Refresh</button>
    </div>
  </div>

  <div id="headline-container">
    <div id="verification-banner" class="hidden">
      ğŸ” VERIFICATION MODE â€” ANALYZING STATISTICAL DEVIATION
    </div>
    <div id="ai-title">
      Can lottery randomness be cracked?
    </div>
  </div>

  <div class="grid">
    <div class="grid-column left">
      <div class="card wide">
        <div class="card-title" id="panelTitle">Number Frequency Heatmap</div>
        <div id="chartMain"></div>
        <div class="foot">
          <span id="statusLine">Monitoringâ€¦</span>
          <span id="updatedAt"></span>
        </div>
        <div class="info-box">
          <strong>What this shows:</strong> How often each number appeared in recent draws. Bright = frequent, Dark = rare. 
          <strong>Key insight:</strong> Past patterns don't predict future drawsâ€”each draw is independent.
        </div>
      </div>
      
      <div class="card wide">
        <div class="card-title">ğŸ”¬ AI Autonomous Research Lab</div>
        <div id="researchOut" class="research"></div>
        <div class="info-box">
          <strong>What's happening:</strong> AI proposes new pattern hypotheses every ~2 minutes, tests them against 20 years of data, shows its reasoning process, and reports findings. Watch the AI think in real-time!
        </div>
      </div>
    </div>
    
    <div class="grid-column right">
      <div class="card">
        <div class="card-title">ğŸ¯ Myth Debunking Lab</div>
        <div id="baitPanel" class="bait"></div>
        <div class="rotating-panels">
          <div class="myth-explainer panel-content" id="mythContainer">
            <!-- Myths will be dynamically rotated here -->
          </div>
          <div class="prediction-tracker panel-content" id="predictionContainer" style="display:none;">
            <!-- Prediction stats will be dynamically loaded here -->
          </div>
        </div>
        <div class="panel-indicator">
          <span class="dot active" data-panel="myth"></span>
          <span class="dot" data-panel="prediction"></span>
        </div>
      </div>

      <div class="card">
        <div class="card-title">ğŸ“Š Randomness Verification</div>
        <div id="chartMonte" class="chart"></div>
        <div class="info-box">
          <strong>What this shows:</strong> Orange line = actual lottery. Blue band = expected random behavior.<br>
          <strong>Result:</strong> <span id="monteVerdict" class="verdict-good">âœ“ Behaving randomly</span>
        </div>

        <!-- AI LOTTERY PREDICTIONS (Based on CANDIDATE Patterns) -->
        <div id="lotteryPredictionContainer"></div>
      </div>
    </div>
  </div>

  <div class="footer">
    ENTROPY uses publicly available draw data for identification/audit purposes only. No affiliation or endorsement implied. No gambling advice.
  </div>

  <script src="/static/app.js"></script>
  <script>
// Fetch and display AI lottery predictions
async function displayLotteryPredictions() {
  const container = document.getElementById('lotteryPredictionContainer');
  if (!container) {
    console.log('[LOTTERY] Container not found');
    return;
  }

  try {
    const feed = document.getElementById('feedSelect').value || 'powerball';
    console.log('[LOTTERY] Fetching prediction for:', feed);
    const res = await fetch(`/api/lottery-prediction/${feed}`);
    const data = await res.json();
    console.log('[LOTTERY] Response:', data);

    if (!data.prediction) {
      console.log('[LOTTERY] No prediction in response');
      container.innerHTML = '';
      return;
    }

    const pred = data.prediction;
    const gameInfo = {
      powerball: { name: 'Powerball', ballClass: 'powerball', mainClass: 'powerball-main', bonusClass: 'powerball-bonus' },
      megamillions: { name: 'Mega Millions', ballClass: 'megamillions', mainClass: 'megamillions-main', bonusClass: 'megamillions-bonus' }
    };

    const game = gameInfo[feed] || gameInfo.powerball;
    let ballsHtml = pred.numbers.map(n => `<div class="lottery-ball ${game.mainClass}">${n}</div>`).join('');
    if (pred.bonus) {
      ballsHtml += `<div class="lottery-ball ${game.bonusClass}">${pred.bonus}</div>`;
    }

    console.log('[LOTTERY] Generated HTML:', ballsHtml);
    container.innerHTML = `
      <div class="lottery-prediction-container">
        <div class="lottery-title">ğŸ° AI Prediction (Based on CANDIDATE Patterns)</div>
        <div class="lottery-balls-container">${ballsHtml}</div>
        <div class="lottery-reasoning">ğŸ“Š ${pred.reasoning}</div>
        <div class="lottery-disclaimer">âš ï¸ Research analysis only. Not gambling advice. Each draw is independent.</div>
      </div>
    `;
    console.log('[LOTTERY] Rendered successfully');
  } catch (err) {
    console.error('[LOTTERY] Error:', err);
  }
}

// Call when page loads and when feed changes
document.addEventListener('DOMContentLoaded', () => {
  displayLotteryPredictions();
  const feedSelect = document.getElementById('feedSelect');
  if (feedSelect) {
    feedSelect.addEventListener('change', displayLotteryPredictions);
  }
});

// Refresh predictions every 2 minutes along with other data
setInterval(displayLotteryPredictions, 120000);
  </script>
</body>
</html>